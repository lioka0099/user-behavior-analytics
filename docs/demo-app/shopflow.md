# Demo App - ShopFlow (Android)

ShopFlow is an Android demo application that consumes the published **User Behavior Analytics** Android SDK and sends events to the backend API.

Project location: `demo-app/ShopFlow/`

## What it demonstrates

- How an Android app integrates the SDK from **JitPack**
- How to configure:
  - backend `endpoint`
  - `api_key` generated for a tracked app/project
- How to track common user journey events:
  - `home_view`, `product_view`, `add_to_cart`, `checkout_start`, `purchase_complete`, etc.
- How events appear in the dashboard analytics pages after ingestion

## Screenshots

These screenshots are stored in `docs/assets/`:

### Home screen

<img src="../assets/ShopFlow_Homescreen.jpg" alt="ShopFlow Home screen" width="300" />

### Product view

<img src="../assets/ShopFlow_ProductView.jpg" alt="ShopFlow Product view" width="300" />

### Shopping cart

<img src="../assets/Shopflow_ShoppingCart.jpg" alt="ShopFlow Shopping cart" width="300" />

### Checkout

<img src="../assets/Shopflow_Checkout.jpg" alt="ShopFlow Checkout" width="300" />

## Requirements

- Android Studio
- JDK 17
- A running backend API (local or deployed)
- An `api_key` generated by the backend (usually obtained via the dashboard app management)

## How ShopFlow is configured

The demo app defines its analytics config in `demo-app/ShopFlow/app/build.gradle.kts`:

- `ANALYTICS_API_KEY`
- `ANALYTICS_ENDPOINT`

Example (current repo values):

```kotlin
buildConfigField("String", "ANALYTICS_API_KEY", "\"app_c30f3d37\"")
buildConfigField("String", "ANALYTICS_ENDPOINT", "\"https://user-behavior-analytics-production.up.railway.app/\"")
```

These become `BuildConfig.ANALYTICS_API_KEY` and `BuildConfig.ANALYTICS_ENDPOINT` at runtime.

## SDK initialization (in the demo app)

ShopFlow initializes the SDK in `MainActivity.onCreate()`:

```kotlin
AnalyticsSDK.init(
  context = this,
  apiKey = BuildConfig.ANALYTICS_API_KEY,
  endpoint = BuildConfig.ANALYTICS_ENDPOINT
)

AnalyticsSDK.track("app_open", mapOf("launch_source" to "direct"))
```

And flushes when the app goes to background:

```kotlin
override fun onStop() {
  super.onStop()
  AnalyticsSDK.flush()
}
```

## Running the demo app

1. Open Android Studio
2. **Open** the project folder: `demo-app/ShopFlow`
3. Sync Gradle
4. Select an emulator or a physical device
5. Run the `app` configuration

### Using a deployed backend (recommended)

Set:

- `ANALYTICS_ENDPOINT` = your deployed backend base URL (must end with `/`)
- `ANALYTICS_API_KEY` = a real API key created for your tracked app

### Using a local backend

If you run the backend locally at `http://localhost:8000`:

- Android emulator should use: `http://10.0.2.2:8000/`
- Physical device should use: `http://<your-lan-ip>:8000/`

Update the two `buildConfigField(...)` values accordingly.

## Verifying that events are being sent

### 1) Check Android Studio Logcat

Search for `AnalyticsSDK` logs. Successful ingestion typically looks like:

- “SDK initialized…”
- “✓ Events sent successfully (200)”

### 2) Check backend `/docs` (optional)

If running locally, open:

- `http://localhost:8000/docs`

You can also manually call `POST /events` from Swagger UI to verify ingestion works.

### 3) Check the dashboard

After events are ingested:

- Open the dashboard
- Select the correct app/api key
- Confirm events appear in:
  - Dashboard charts (event volume)
  - Events list / counts page
  - Funnels (if you define and run them)
  - Insights (if you generate them)

## Troubleshooting

### No events in dashboard

Checklist:

- Verify the demo app is using the correct `ANALYTICS_API_KEY`
- Verify `ANALYTICS_ENDPOINT` is reachable from emulator/device
- Confirm the backend is running and accepting requests (`/docs`)

### Emulator cannot reach backend

- Use `10.0.2.2` for the Android emulator (not `localhost`)
- Ensure your backend is bound to a reachable interface and correct port

